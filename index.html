<!-- Start writing your project code in this file! -->
<meta name="color-scheme" content="dark">

<button onclick="intro()">Hide/Show Text</button>
<button onclick="lucky()">Hit Me!</button>
<button onclick="playerStand()">Stand</button>
<div id="infoElement"></div>
<div id="dealerElement"></div>
<div id="playerElement"></div>

<script>
var info = "Introduction text";
var dealer = 0;
var player = 0;
var deck = [];
var dHistory = 0;
var pHistory = 0;
var dStand = false;
var dStood = "";
var pStood = "";

var infoOutput = document.getElementById("infoElement");
var dealerOutput = document.getElementById("dealerElement");
var playerOutput = document.getElementById("playerElement");

infoOutput.innerText = info;
dealerOutput.innerText = "Dealer: " + dealer + " (" + dHistory + ") " + dStood;
playerOutput.innerText = "Player: " + player + " (" + pHistory + ") " + pStood;

function deckCreation() {
  // "deck = [];" is used to clear the deck whenever a new one is created, so that the new cards aren't just added on top of the old deck
  deck = [];
  //The two subordinate for loops create a full suit of cards, with the overarching for loop repeating the subordinate loops until all 4 suits have been created
  for (var suit = 1; suit < 5; suit++) {
    console.log("suit " + suit)
    for (var card = 1; card < 11; card++) {
      console.log("card " + card)
      deck.push(card);
    }
    //Every loop the faceTen variable is applied to the deck instead of the face variable itself
    for (var face = 1; face < 4; face++) {
      console.log("face " + face)
      faceTen = 10
      deck.push(faceTen);
    }
  }
}
deckCreation()

//Draws the dealers card
function dealerRound() {
  var random = Math.random()
  console.log(random)
  //The "deck.length" is used due to the size of the deck changing over the course of the game
  //Since the calculation uses a decimal numbers (The random var) the Math.floor is used to round it down to the nearest whole number
  var draw = Math.floor(random*deck.length)
  console.log(deck.length)
  console.log(draw)
  dealer += deck[draw]
  dealerHistory(deck[draw])
  spliceatron9000(draw)
}

//Draws the players card
function playerRound() {
  var random = Math.random()
  var draw = Math.floor(random*deck.length)
  player += deck[draw]
  playerHistory(deck[draw])
  spliceatron9000(draw)
}

//Removes drawn cards from the deck
function spliceatron9000(ph) {
  deck.splice(ph, 1)
}

//Display the last drawn cards
function dealerHistory(ph) {
  console.log("Dealer drew " + ph)
  dHistory = ph;
}
function playerHistory(ph) {
  console.log("Player drew " + ph)
  pHistory = ph;
}


//TODO: Make the player and dealer histories into variables, find a way to access said variables in the updateScreen and then add them to Player/Dealer outputs
function updateScreen() {
dealerOutput.innerText = "Dealer: " + dealer + " (" + dHistory + ") " + dStood;
playerOutput.innerText = "Player: " + player + " (" + pHistory + ") " + pStood;
}

function intro () {
  if (info == "Introduction text") {
    info = " "
  }
  else {
    info = "Introduction text"
  }
  infoOutput.innerText = info;
}

//This overarching function exists so that both the round and updateScreen can be tied to one button (+more stuff)
function lucky () {
  if (dStand = true) {
    if (dealer < 12) {
      dealerRound();
    }
    else if (dealer < player && dealer < 17) {
      dealerRound();
    }
    else {
      dStand = true
      dStood = "Stood"
    }
  }
  
  playerRound();
  updateScreen();
  if (player > 21) {winner()}
  else if (dealer > 21) {winner()}
}

//If the player stands, then the dealer will be able to continue drawing cards independently
function playerStand () {
  pStood = "Stood"
  if (dealer <= player) {
    dealerRound();
    updateScreen();
    if (dealer > 21) {winner()}
    else {setTimeout(playerStand, 1000)}
  }
  else (winner())
}

//winner function calculates who has won when the game ends
function winner () {
  if (player == dealer) {console.log("draw")}
  else if (player > 21 && dealer > 21) {console.log("bust draw")}
  else if (player > dealer && player <= 21) {console.log("player win 1")}
  else if (player <= 21 && dealer > 21) {console.log("player win 2")}
  else if (dealer > player && dealer <= 21) {console.log("House win 1")}
  else if (dealer <= 21 && player > 21) {console.log("House win 2")}
  else {console.log("Ops, some error has appeared")}
}

</script>